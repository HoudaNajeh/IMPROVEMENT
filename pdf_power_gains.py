from scipy.stats import t
import scipy.stats
import matplotlib.pyplot as plt
import numpy as np
import math
from scipy.stats import t
import scipy.stats
import scipy.stats as stats
from scipy.stats import uniform
def moyenne(tableau):
    return sum(tableau, 0.0) / len(tableau)
#La variance est définie comme la moyenne des carrés des écarts à la moyenne
def variance(tableau):
    m=moyenne(tableau)
    return moyenne([(x-m)**2 for x in tableau])

#L'écart-type est défini comme la racine carrée de la variance
def ecartype(tableau):
    return variance(tableau)**0.5
power_gains= [446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.7637448543506, 450.0563576349626, 452.31415396540126, 453.69370859372896, 483.60910117143203, 487.21322157999043, 528.9154493852493, 529.6148980769025, 529.4699910262124, 528.7598289757213, 526.1550863177042, 519.5167619356741, 453.8656655399551, 452.41579179287277, 450.50574995170996, 447.3101345985467, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.7841237222222, 446.80054427777776, 446.9407485259267, 450.0726978428755, 452.32134636193445, 453.69688609505465, 483.3304696823446, 486.9568465716337, 488.4384673075218, 492.79967185684603, 694.5208621235147, 488.5926164728944, 487.2383652506719, 483.96591904203456, 619.447637194847, 452.59849481165685, 450.53461353044395, 447.3533144631737, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.980397942288, 450.0873572828232, 454.6171734834969, 760.5869328063357, 664.2815233505972, 687.8793264394626, 679.073696519215, 665.7287318869658, 504.46917969047524, 849.2097705307547, 658.6975109725356, 492.08999835137496, 617.6084691199767, 475.6393188193666, 455.01095534030526, 448.14022739375906, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 447.0412487307211, 453.4346978522386, 457.80408599209306, 466.1439800899069, 547.2138998286134, 568.5419271990701, 580.3444694308371, 573.6326535174485, 573.4502649640308, 560.5195954706637, 557.1971256216477, 547.972386680269, 466.6624917891917, 463.1814058282064, 457.56498063923055, 448.21854063485415, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.88663464328806, 450.43950178998125, 452.647637889839, 460.4857420475054, 517.9386951830979, 486.72051878533455, 568.5225872562161, 565.9153009655145, 562.5154198459034, 561.214446528816, 557.4959933847529, 548.4897921356082, 468.7535368438081, 464.9310032986447, 458.77189980822203, 449.22239776350017, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 447.11056336177074, 453.47605200659723, 457.82033760295064, 806.9778505469426, 766.8236849215036, 934.4776639622153, 1088.4925941732845, 919.5753854691827, 946.0638272946346, 1072.3664876486366, 919.2514440221914, 906.2927854879813, 643.992561595508, 460.4889630495653, 454.6923581926218, 449.07995019470945, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 447.3352673333333, 447.7300988882265, 457.494915983258, 467.1624186753792, 818.128126667604, 808.7729476887798, 787.774626003592, 606.4657442190594, 759.2864197909166, 726.7801511191069, 861.1300481506162, 564.1092017322277, 548.7467760719423, 478.3159995180759, 470.05920430985077, 467.7612579397608, 451.3856379345491, 447.43397431082275, 452.8089319598364, 449.67148522846924, 451.87617635694625, 449.36326054785985, 447.6382360014718, 446.616114, 452.1841641162202, 456.87656552997373, 452.3912515618544, 461.7205321341938, 791.2132092207796, 824.7496600613556, 923.8685888146163, 760.406739793118, 903.427513558587, 777.5154021152115, 1098.784598295191, 929.6229304316125, 907.186143888192, 668.8777580022074, 472.34239747569586, 457.65823364935443, 449.54249860364456, 446.616114, 446.2808015, 446.44845566666663, 446.616114, 446.616114, 446.616114, 446.616114, 446.6377678888889, 447.0520834914384, 450.14132230859275, 627.1495951051197, 637.5226035351001, 747.4176029511077, 898.628361890806, 750.3588472683318, 595.7130064209941, 786.006683411749, 943.0737784212477, 760.0799239926149, 761.6254497126455, 476.564988313728, 470.46052035311, 459.6042521058979, 449.6859942185923, 446.4484698333333, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.9390187222222, 447.2116200957427, 453.68982467871183, 457.8334504120677, 628.1993974179553, 882.5228934464266, 870.7078796654234, 736.3901335783823, 550.1126913440831, 695.3430598037558, 808.7149027382591, 823.2083274378408, 839.7637136067942, 501.08592744542517, 460.07843913420356, 454.99143000478495, 448.6204841150158, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.78417566666667, 447.4522989842959, 456.3468024828542, 457.8328168697394, 466.14895220648077, 547.6427202596446, 558.8806547000684, 586.175672741364, 577.612776497946, 563.3072911713349, 528.756960959757, 525.9912264636512, 519.5360052690742, 460.9399328697149, 458.537371782217, 454.69144377138207, 449.5166915966975, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 447.38532662710213, 453.5266837077678, 457.83065844146245, 460.48294304325816, 526.1698021265713, 537.4887948029838, 551.4219963469119, 539.3902200286636, 536.5687711236842, 565.3891513589932, 559.7783745763892, 550.3472187950296, 468.88558748793037, 465.1652185579983, 459.2147829465644, 447.6416064926324, 446.3342276111111, 446.5743734444444, 446.3225884444444, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 447.4673267252451, 456.3455290768658, 462.4042986008816, 982.2627422362345, 1048.7816809561052, 1032.0760412990896, 880.4866456834702, 718.0485942442008, 871.3401516790711, 1024.0880618847345, 991.7452718862482, 822.5688238838372, 468.14124656216154, 463.45433249369756, 458.08117574998425, 447.71974851403144, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.616114, 446.64064677777776, 447.06809272366394, 450.14395023121494, 456.1032654849802, 500.2466136206404, 897.1004137829179, 1059.7188548039837, 882.1022516484243, 873.6939518716399, 1059.6513464675918, 1083.727519165221, 915.4111611714957, 896.8110836070249, 663.4748266289635, 498.79110815169497, 465.31003071870964, 456.2092271265653, 452.616114, 452.616114, 452.616114, 452.616114, 452.616114, 452.11310594444444, 452.2807251111111, 452.44841983333333, 453.3829743289683, 458.91661231146423, 477.3649076444935, 641.4823784625435, 824.3400902364865, 880.7819948427359, 860.3489282054081, 890.0252450344078, 1066.7042135351069, 905.1895661458211, 897.8216208266704, 713.266329628324, 666.6332739248971, 467.44988894533714, 456.79195428125024, 453.8619199427036, 452.1168637222222, 451.7875212222222, 451.7841609444444, 451.616114, 451.78413788888884, 451.90780483333333, 451.6604637222222, 452.2276753888889, 452.48207955382463, 455.134709989421, 457.3346396153368, 674.3064101494216, 841.6364012138724, 807.8349445295407, 524.7357581077197, 526.7702241649029, 513.1533408724716, 586.9616849554629, 585.4477245134658, 575.9673831582252, 475.9760428583728, 469.5167618769454, 463.77379134260985, 454.83184934126893, 451.78411316666666, 451.616114, 451.616114, 451.7841351111111, 451.616114, 451.78414316666664, 451.616114, 451.95213149999995, 452.5970985364196, 461.2946612236508, 490.5540282735715, 869.7891732328524, 1074.2007468448821, 940.4735384752203, 924.1903379209339, 769.5028618672193, 1077.735747697236, 932.136413618817, 748.854232968112, 748.6271281929075, 663.1213820830201, 657.6418447878071, 463.63566869984106, 454.87971337593405, 451.616114, 451.616114, 451.616114, 451.616114, 451.616114, 451.616114, 451.616114, 451.784124, 452.1766532485261, 458.6405846031447, 462.78664051848614, 458.68368817366206, 524.4777637114723, 531.9580700936041, 569.2935798156288, 570.3929962253461, 570.5097480840891, 494.42338365971887, 493.1855738452594, 490.1185147069758, 458.96550349673447, 457.9282766497217, 455.8401302248949, 452.8157888839128, 451.616114, 451.616114, 451.616114, 451.616114, 451.616114, 451.616114, 451.616114, 451.616114, 451.89201227329954, 455.1101264483314, 457.31784870648306, 471.08194612232006, 554.1697371639036, 564.732078846871, 494.2049767848006, 494.61163424473074, 494.65567730739247, 569.0324671104377, 577.36524056394, 568.0306895208432, 471.87914351345876, 468.5645906299841, 463.28317295250406, 455.36233761575363, 451.7837881666667, 451.616114, 451.616114, 451.616114, 451.616114, 451.616114, 451.616114, 451.8662728888889, 452.42779124884873, 461.21522314579977, 633.4296258893586, 859.5355867599305, 767.9802327373568, 906.9973992994348, 914.9490065499788, 733.1912756959184, 703.088004882535, 771.7625902848015, 794.9302145083559, 717.2731430549964, 462.1925246993965, 459.6598749403919, 456.08432121056256, 450.0133336307839, 447.616114, 447.616114, 447.616114, 447.95149066666664, 448.1191901111111, 447.7992873333333, 447.7682659444444, 448.1192042777777, 448.36813962471246, 451.2544144429139, 454.12603306724645, 470.2108410578215, 695.4634569507311, 674.5095180720141, 660.1927681604145, 662.5126368712099, 814.2028115647013, 905.0996842148556, 883.212867290483, 723.8240104629708, 470.5008524057504, 466.9663307829471, 460.73419844353134, 451.4285714803908, 447.616114, 447.78384177777775, 447.6697998333333, 448.06537316666663, 448.1190903888889, 448.32253149999997, 448.251169, 447.9750426111111, 448.99871709911207, 458.78659934295115, 465.8088080551902, 484.3841040640118, 577.3034811295798, 750.4128208815612, 617.9372370616561, 609.2384875894959, 935.0256049231189, 915.8023055979613, 721.0332832533932, 549.3436894216029, 470.7234046795368, 466.64138224440603, 461.25510821964735, 451.71515760095315, 448.19208649999996, 447.95148927777774, 447.616114, 447.616114, 447.616114, 447.7837534444444, 447.616114, 447.7837926111111, 448.65270821828625, 458.70606689132137, 466.9808175974572, 665.2542999701661, 755.256471779175, 773.934618835214, 911.2133064193763, 743.4893130174644, 912.6414528092232, 1125.786716530815, 1110.6472829408372, 939.5776434086861, 668.2080987286008, 480.5305875782671, 473.3933988751071, 455.4708147548857, 454.3971057506801, 451.616114, 451.6161140000002, 451.616114, 451.616114, 451.616114, 451.616114, 451.616114, 452.2151210141302, 467.72484591559146, 476.5333157791125, 487.8564321756434, 567.5041985155644, 749.498114277631, 785.3136802358613, 934.7234171392663, 927.5056758495591, 889.5076030909505, 881.6720154031052, 764.0314579527601, 683.8483197314247, 526.6956420736853, 511.5315172140997, 481.2112314617889, 473.1439614466277, 475.7731543225674, 476.3202385966151, 463.6710717841154, 466.52119079395914, 465.9650038311334, 462.1161745111109, 465.4062563804976, 468.53935384247734, 472.3495246112651, 471.7796398530036, 485.6331349804057, 572.6697406007179, 508.24013246600856, 530.7602951241072, 520.6631942039829, 505.3826839300128, 571.1185478667481, 567.3893621384544, 559.8047795414025, 472.4962899329928, 469.6014331355961, 464.3693035625142, 457.9124055656195, 452.5717497633101, 452.1204378888889, 452.4567315, 451.7842009444444, 451.6161140000002, 457.0964293095184, 456.97620218093897, 454.09699722759535, 453.1583134988146, 458.2494860988254, 463.1142802280065, 474.47845492759143, 536.6213461947779, 545.5394155089145, 551.7675694794898, 552.4554391609922, 547.7343063776448, 545.2101459130181, 535.8245541498052, 528.7041627392782, 473.6875076129252, 467.6445502730787, 460.9638094505203, 454.72374873014826, 452.45837177777776, 452.616114, 452.27991844444443, 451.9678373333333, 451.616114, 452.4151526111111, 452.2798976111111, 452.616114, 453.15521960564956, 462.25723192685643, 468.88844610909973, 489.09480119630507, 726.8140985418609, 751.9295836552999, 619.9575565734772, 623.5043134558159, 921.5525597068904, 967.5397885386583, 609.7762190055778, 576.0158200993376, 483.8350909931773, 479.0928764860066, 465.0887307460606, 455.8179244227188, 452.08242399999995, 452.44799316666666, 451.943609, 452.11187094444443, 451.68010594444445, 452.20745288888884, 452.0333973333333, 452.19010649999996, 452.51090690871007, 462.28099516428557, 468.96324195419004, 479.24709891186575, 725.0954074519468, 783.5064780217799, 791.0552940610376, 614.4230615863353, 785.9789581497862, 774.760494950116, 770.0598739725863, 600.4696251338879, 475.426642293726, 470.6839732108922, 465.60185463564915, 455.8051862588878, 451.94672788888886, 452.1117937222222, 451.63053149999996, 451.616114, 451.616114, 451.616114, 451.616114, 451.8860056666666, 452.05184312735815, 461.8725762796827, 468.90679994413915, 474.14477923455814, 700.6058293230665, 747.4448901893838, 767.2900417942014, 729.6286722724144, 765.089258765292, 921.8720258001515, 745.6501216360264, 576.3976118478304, 542.7158594922481, 469.22862782860386, 464.3601183768872, 455.2727504636341, 451.8680965, 452.27983622222223, 451.70920677777775, 452.2886226111111, 451.7837698333333, 452.32854538888887, 452.27988066666666, 452.616114, 452.6501630239824, 455.06720209892217, 469.6566715981042, 627.1078328188648, 687.8816100693609, 560.1605004193127, 592.27309380901, 602.217942255659, 905.1675425126662, 927.5127541256645, 877.7793779809572, 757.1545490716724, 561.5600405557577, 478.5459708979016, 471.7710742417885, 463.51622001704413, 458.28889826082826]
# #loi normale
samples = np.array(power_gains)
# mu=variance(power_gains)
# sigma=ecartype(power_gains)
# print('sigma_data=', sigma)
# print('mu_data=', mu)
# plt.hist(samples, bins=50, alpha=0.3, label='histogram')
# plt.ylabel('% of Dataset in Bin')
# plt.xlabel('power gains')
# plt.title('Histogram representation for power gains')
# plt.legend()
# y = scipy.stats.norm.pdf(samples, mu, sigma)
# plt.figure(2)
# plt.plot(y, color='r', label='pdf')
# plt.xlabel('power gains')
# plt.ylabel('probability')
# plt.legend()
# plt.title('Test of normal PDF for power gains')
# plt.show()
################# loi Student
# mu=variance(samples)
# sigma=ecartype(samples)
# print('sigma_data=', sigma)
# print('mu_data=', mu)
# df = 0.2
# plt.hist(samples, bins=50, alpha=0.3, label='histogram')
# plt.ylabel('% of Dataset in Bin')
# plt.xlabel('power gains')
# plt.title('Histogram representation for power gains')
# plt.legend()
# mean, var, skew, kurt = t.stats(df, moments='mvsk')
# plt.figure(2)
# plt.plot(samples, t.pdf(samples, df),'r',  alpha=0.2, label=' pdf')
# rv = t(df)
# plt.legend(loc='best', frameon=False)
# plt.xlabel('power gains')
# plt.ylabel('probability')
# plt.title('Test of student PDF for power gains')
# plt.show()
############### loi uniforme
plt.hist(samples, density=True, bins=50, alpha=0.3, histtype='stepfilled', label='histogram')
plt.ylabel('% of Dataset in Bin')
plt.xlabel('power gains')
plt.title('Histogram representation for power gains')
plt.legend()
mean, var, skew, kurt = uniform.stats(moments='mvsk')
plt.figure(2)
#samples = np.linspace(uniform.ppf(0.01), uniform.ppf(0.99), 100)
plt.plot(samples, uniform.pdf(samples), 'r', alpha=0.3, label='uniform pdf')
plt.legend(loc='best', frameon=False)
plt.xlabel('power gains')
plt.ylabel('probability')
plt.legend()
plt.title('Test of Uniform PDF for power gains')
plt.show()